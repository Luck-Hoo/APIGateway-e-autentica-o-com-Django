{% extends "base.html" %}
{% load static %}

{% block title %}Consulta Contratações - Gateway API{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/theme-tables.css' %}" />
{% endblock %}

{% block content %}
<div class="hero-section shadow-sm">
  <h1 class="display-5 fw-bold">Consulta de Contratações (PNCP)</h1>
  <p class="lead mt-3">
    Busque contratos públicos usando filtros de Unidade Gestora e período.
  </p>
</div>

<div class="row justify-content-center mb-4 g-3">
  <h3 class="mb-3 text-primary">Parâmetros de Pesquisa</h3>
  <div class="col-sm-6 col-lg-2">
    <label for="unidadeGestora-input" class="form-label text-muted">Código da Unidade Gestora</label>
    <input id="unidadeGestora-input" type="text" class="form-control" placeholder="Ex: 155010 - Ebserh/MA" />
  </div>

  <div class="col-sm-6 col-lg-2">
    <label for="codigoModalidade-input" class="form-label text-muted">Código da modalidade da licitação*</label>
    <input id="codigoModalidade-input" type="number" class="form-control" placeholder="Ex: 5" required />
  </div>

  <div class="col-sm-6 col-lg-2">
    <label for="dataInicial-input" class="form-label text-muted">Data inicial da publicação no PNCP*</label>
    <input id="dataInicial-input" type="date" class="form-control" value="" required />
  </div>

  <div class="col-sm-6 col-lg-2">
    <label for="dataFinal-input" class="form-label text-muted">Data final da publicação no PNCP*</label>
    <input id="dataFinal-input" type="date" class="form-control" value="" required />
  </div>

  <div class="col-sm-6 col-lg-2">
    <label for="tamanhoPagina-select" class="form-label text-muted">Tamanho da Página</label>
    <select id="tamanhoPagina-select" class="form-select">
      <option value="10" selected>10 registros</option>
      <option value="20">20 registros</option>
      <option value="50">50 registros</option>
    </select>
  </div>

  <div class="col-sm-6 col-lg-2 d-flex align-items-end">
    <button id="search-btn" class="btn btn-primary w-100">
      <i class="bi bi-search"></i> Consultar
    </button>
  </div>
</div>

<div id="status-message" class="text-center my-3 text-muted"></div>

<div id="contratacoes-data-table" style="display: none">
  <h3 class="mb-3 text-primary">Contratos Encontrados</h3>
  <div class="table-responsive">
    <table class="table table-bordered table-hover">
      <thead class="table-primary">
        <tr>
          <th>Contrato</th>
          <th>Núm Compra</th>
          <th>Fornecedor</th>
          <th>Modalidade</th>
          <th>Processo</th>
          <th>Núm Parcelas</th>
          <th>Valor Parcelas (R$)</th>
          <th>Valor Global (R$)</th>
          <th>Vigência Inicial</th>
          <th>Vigência Final</th>
        </tr>
      </thead>
      <tbody id="table-body"></tbody>
    </table>
  </div>
  <div class="text-end mt-3">
    <button id="load-more-btn" class="btn btn-outline-primary" style="display: none">
      Carregar Mais...
    </button>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script type="module" src="{% static 'js/consulta_contratos.js' %}"></script>
{% endblock %}